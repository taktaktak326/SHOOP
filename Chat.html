<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>チャットボットサイト</title>
    <link rel="stylesheet" href="https://www.gstatic.com/dialogflow-console/fast/df-messenger/prod/v1/themes/df-messenger-default.css">
    <script src="https://www.gstatic.com/dialogflow-console/fast/df-messenger/prod/v1/df-messenger.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f3f3f3;
        }

        header {
            background-color: #4CAF50;
            padding: 10px 20px;
            color: white;
            text-align: center;
        }

        main {
            padding: 20px;
            text-align: center;
        }

        #response-time {
            font-size: 24px;
            font-weight: bold;
            color: #ff0000;
            text-align: center;
            margin-top: 20px;
        }

        df-messenger {
            z-index: 999;
            position: fixed;
            width: 100%; /* Responsive width */
            height: 50vh; /* Responsive height, 50% of viewport height */
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            --df-messenger-font-color: #000;
            --df-messenger-font-family: Google Sans;
            --df-messenger-chat-background: #f3f6fc;
            --df-messenger-message-user-background: #d3e3fd;
            --df-messenger-message-bot-background: #fff;
            --df-messenger-message-actor-image-size: 60px;
        }

        @media (max-width: 600px) {
            df-messenger {
                width: 100%;
                height: 40vh; /* Adjust height for mobile */
                top: 0; /* モバイルでは上部に固定 */
                transform: translate(0, 0); /* 位置調整 */
            }
        }
    </style>

</head>
<body>
    <header>
        <h1>チャットボットサイト</h1>
    </header>
    <main>
        <div id="response-time">レスポンス時間: 0秒</div> <!-- レスポンス時間を表示する要素 -->
    </main>
    <df-messenger
        intent="WELCOME"
        chat-title="チャットボットテスト"
        agent-id="a1665471-9343-46bb-a513-398bfaaca268"
        language-code="ja"
        chat-icon="https://your-image-hosting-site.com/path-to-icon.png"
        bot-actor-image="https://your-image-hosting-site.com/path-to-image.jpg"
        allow="microphone; geolocation"
        mic-active="true"
        agent-id="a1665471-9343-46bb-a513-398bfaaca268"
        session-id="unique-user-id"
        min-session-timeout="3600"
        user-id="unique-user-id"
        project-id="prj-basf-xarviobot-dev"
        max-query-length="-1"
        allow-feedback="all"
        url-allowlist="*">
    </df-messenger>

    <script>
        let startTime;
        let timerInterval;

        // メッセージが送信されるとき
        window.addEventListener('dfMessengerSendMessage', function() {
            startTime = new Date();
            clearInterval(timerInterval);
            timerInterval = setInterval(updateTimer, 100); // 100msごとにカウントアップ
        });

        // チャットボットからレスポンスが返却されたとき
        window.addEventListener('dfMessengerResponseMessage', function() {
            if (startTime) {
                const endTime = new Date();
                const responseTime = ((endTime - startTime) / 1000).toFixed(2);
                document.getElementById('response-time').textContent = `レスポンス時間: ${responseTime}秒`;
                clearInterval(timerInterval);
            }
        });

        // タイマーを更新する関数
        function updateTimer() {
            const currentTime = new Date();
            const elapsedTime = ((currentTime - startTime) / 1000).toFixed(2);
            document.getElementById('response-time').textContent = `レスポンス時間: ${elapsedTime}秒`;
        }
    </script>
</body>
</html>
